{% extends 'pbn/service_2/base.html' %}
{% load static %}
{% block index %}<meta name="robots" content="index, follow" />{% endblock index %}
{% block canonical %}https://{{ request.get_host }}{% url "blog" %}{{ category_slug }}/{{ slug }}/{% endblock canonical %}
{% block content %}
    <!--  Крошки  -->
    <section class="breadcrumb mb-6">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="breads">
                        <ul itemscope itemtype="http://schema.org/BreadcrumbList">
                            <li itemprop="itemListElement"
                                itemscope
                                itemtype="http://schema.org/ListItem">
                                <a itemprop="item" href="/"><span itemprop="name">Главная</span></a>
                                <meta itemprop="position" content="1" />
                            </li>
                            <li itemprop="itemListElement"
                                itemscope
                                itemtype="http://schema.org/ListItem">
                                <a itemprop="item" href="{% url "blog" %}"><span itemprop="name">{{ name_info }}</span></a>
                                <meta itemprop="position" content="2" />
                            </li>
                            <li itemprop="itemListElement"
                                itemscope
                                itemtype="http://schema.org/ListItem">
                                <a itemprop="item" href="{% url "blog" %}{{ category_slug }}/"><span itemprop="name">{{ category_name|capfirst }}</span></a>
                                <meta itemprop="position" content="3" />
                            </li>
                            <li itemprop="itemListElement"
                                itemscope
                                itemtype="http://schema.org/ListItem">
                                <span itemprop="name">{{ name|capfirst }}</span>
                                <meta itemprop="position" content="4" />
                            </li>
                        </ul>
                    </div>
                    <h1 class="section-title mb-3 fw-bold">{{ name|capfirst }}</h1>
                </div>
            </div>
        </div>
    </section>
    <!--  Информация о статье  -->
    <section class="article-page py-4 py-md-5"
             itemscope
             itemtype="http://schema.org/Article">
        <meta itemprop="headline" content="{{ name|capfirst }}">
        <meta itemprop="author" content="{{ data_author.name|capfirst }}">
        <meta itemprop="publisher" content="{{ request.get_host }}">
        <div class="container">
            <!-- Мета: дата / просмотры / автор -->
            <div class="d-flex flex-wrap align-items-center gap-3 mb-4 small text-muted">
                <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-calendar-event"></i>
                    <span>{{ created|date:"d F Y" }}</span>
                </div>
                <div class="vr d-none d-sm-inline"></div>
                <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-clock"></i>
                    <span>{{ time_read }} мин чтения</span>
                </div>
                <div class="vr d-none d-sm-inline"></div>
                <div class="d-inline-flex align-items-center gap-2">
                    <i class="bi bi-eye"></i>
                    <span>просмотров {{ page_view }}</span>
                </div>
                <div class="vr d-none d-sm-inline"></div>
                <div class="d-inline-flex align-items-center gap-2">
                    <span>Автор: <a href="{% url "list_authors" %}{{ data_author.slug }}/">{{ data_author.name|capfirst }}</a></span>
                </div>
            </div>
            <section class="article-block">
                <div class="container">
                    <div class="row">
                        <div class="col-md-9">
                            <!-- Контент статьи -->
                            <article class="article-content" itemprop="articleBody">{{ text|safe }}</article>
                        </div>
                        <aside class="col-md-3">
                            <!-- Содержание статьи -->
                            <div class="toc-card card border-0 shadow-sm mb-4">
                                <div class="card-header bg-transparent px-4 py-3">
                                    <h2 class="h5 m-0">Содержание</h2>
                                </div>
                                <div class="card-body pt-2 pb-4 px-4">{{ table_content|safe }}</div>
                            </div>
                            <div class="toc-card card border-0 shadow-sm mb-4">
                                <div class="card-header bg-transparent px-4 py-3">
                                    <h2 class="h5 m-0">Топ статей</h2>
                                </div>
                                <div class="card-body pt-2 pb-4 px-4">
                                    <ul class="mb-0 list-group" style="list-style-type: none">
                                        {% for article in list_top_articles %}
                                            <li>
                                                <h4 class="fs-6">{{ article.name|capfirst }}</h4>
                                                <div class="d-flex gap-2" style="font-size: 10px">
                                                    <span>{{ article.created|date:"d.m.y" }}</span>
                                                    <span>Просмотров: {{ article.page_view }}</span>
                                                    <a href="{% url "blog" %}{{ article.category_slug }}/{{ article.slug }}/">Подробнее</a>
                                                </div>
                                                <hr>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </aside>
                    </div>
                </div>
            </section>
        </div>
    </section>
    <!--  Статьи  -->
    <section class="section-articles py-5 mb-5">
        <div class="container">
            <h2 class="section-title fw-bold text-center mb-4">Похожие статьи</h2>
            <div class="row g-4 mb-4">
                {% for article in simular_articles %}
                    <div class="col-12 col-md-6 col-lg-4">
                        <article class="card news-card h-100">
                            <div class="news-thumb ratio ratio-16x9">
                                <img src="/media/{{ article.img_preview }}"
                                     class="img-fluid"
                                     alt="{{ article.name }}"
                                     title="{{ article.name }}">
                            </div>
                            <div class="card-body d-flex flex-column">
                                <div class="news-date mb-2">25.05.2025</div>
                                <h3 class="news-title h4 mb-3">{{ article.name|capfirst }}</h3>
                                <p class="news-excerpt mb-4">{{ article.description }}</p>
                                <a href="{% url "blog" %}{{ article.category_slug }}/{{ article.slug }}/"
                                   class="btn btn-primary w-100 mt-auto">Подробнее</a>
                            </div>
                        </article>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section>
{% endblock content %}
